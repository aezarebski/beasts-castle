<project name="myrmidons" default="build" basedir=".">

    <description>
        Build file for the documentation and to tangle things.
    </description>

    <property name="emacsBatch" value="README.org --batch" />

    <target name="ant-xml">
        <echo>Tangling the build script</echo>
        <exec executable="emacs">
            <arg line="${emacsBatch} --eval='(org-babel-tangle)'" />
        </exec>
        <echo>Linting the build script</echo>
        <exec executable="xmllint" >
            <arg line="--format --pretty 1 --output build.xml build.xml" />
        </exec>
    </target>

    <target name="documentation">
        <echo>Weaving the HTML</echo>
        <exec executable="emacs">
            <arg line="${emacsBatch} --eval='(org-html-export-to-html)'" />
        </exec>
    </target>

    <target name="build" depends="ant-xml,documentation" />

    <target name="clean">
        <delete file="README.html" />
        <delete file="build.xml" />
    </target>

</project>
